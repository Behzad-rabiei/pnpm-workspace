name: Review üê≥
run-name: '${{ github.event_name }} ‚Ä¢ ${{ github.ref_name }}@${{ github.sha }}'

on:
    pull_request:
        branches: [main]

concurrency:
    group: ci-${{ github.event.pull_request.number || github.ref }}
    cancel-in-progress: true

jobs:
    quality-gate:
        uses: ./.github/workflows/_quality-gate.yaml
        with:
            node-versions: '20'
    build-review:
        needs: quality-gate
        if: |
            needs.quality-gate.result == 'success' &&
            github.event_name == 'pull_request'
        uses: ./.github/workflows/_build-and-push.yaml
        with:
            ref: ${{ github.sha }}
            tag-suffix: pr-${{ github.event.pull_request.number }}
            push: true
            latest: false
